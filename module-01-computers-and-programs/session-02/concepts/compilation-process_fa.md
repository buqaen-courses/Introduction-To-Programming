# فرآیند کامپایل: از کد تا فایل اجرایی

## به زبان ساده

**چه چیزی یاد می‌گیرید:** آیا تا به حال فکر کرده‌اید چگونه زبان‌هایی مانند C++ کد شما را به برنامه‌هایی تبدیل می‌کنند که می‌توانید با دوبار کلیک کردن اجرا کنید؟ این مقاله شما را در فرآیند کامپایل کامل راهنمایی می‌کند.

**نکته برای تازه‌کاران:** کامپایل را مانند ترجمه و انتشار یک کتاب در نظر بگیرید. شما دست‌نوشته (کد منبع) را می‌نویسید، سپس یک ویراستار آن را بررسی می‌کند (بررسی‌های کامپایلر)، ناشر آن را به زیبایی قالب‌بندی می‌کند (بهینه‌سازی)، و در نهایت آن را چاپ می‌کند (ایجاد فایل اجرایی).

---

## کامپایل چیست؟

**کامپایل** فرآیند ترجمه کل فایل کد منبع شما به کد ماشین **قبل** از اجرای آن است.

| کامپایل (C++، Rust، Go) | تفسیر (پایتون، جاوااسکریپت) |
|------------------------|----------------------------|
| کد ← کامپایل ← فایل اجرایی ← اجرا | کد ← اجرای خط به خط |
| یک‌بار کامپایل، بارها اجرا | هر بار ترجمه |
| سریع در زمان اجرا | کندتر در زمان اجرا |

---

## خط لوله کامپایل: ۷ فاز

```
کد منبع
    ↓
۱. تحلیل لغوی (تبدیل به توکن‌ها)
    ↓
۲. تحلیل نحوی (ساختن درخت AST)
    ↓
۳. تحلیل معنایی (بررسی منطق)
    ↓
۴. تولید کد میانی
    ↓
۵. بهینه‌سازی (سریع‌تر کردن)
    ↓
۶. تولید کد ماشین
    ↓
۷. پیوند (ترکیب کتابخانه‌ها)
    ↓
فایل اجرایی
```

---

## فازهای کامپایل

### فاز ۱: تحلیل لغوی (Tokenization)

کد منبع را به کوچک‌ترین واحدهای معنی‌دار تقسیم می‌کند.

**مثال:**
```cpp
int calculate_sum(int a, int b) {
    return a + b;
}
```

**خروجی توکن‌ها:**
```
[int] [calculate_sum] [(] [int] [a] [,] [int] [b] [)] [{]
[return] [a] [+] [b] [;] [}]
```

### فاز ۲: تحلیل نحوی (Parsing)

بررسی می‌کند آیا توکن‌ها از قوانین دستور زبان پیروی می‌کنند و یک درخت نحو انتزاعی (AST) می‌سازد.

```
    IfStatement
       │
   ┌───┴───┐
   │       │
Condition  ThenBranch
   │       │
  x>5    return true
```

### فاز ۳: تحلیل معنایی

بررسی می‌کند آیا کد از نظر منطقی معنی‌دار است.

**خطاهای گرفته شده:**
- `int x = "hello";` ← خطای نوع
- `y = 5;` ← متغیر اعلام نشده
- `add(1, 2, 3);` ← تعداد آرگومان اشتباه

### فاز ۴ و ۵: کد میانی و بهینه‌سازی

**بهینه‌سازی‌های رایج:**
- **تا کردن ثابت‌ها:** `2 * 3.14159 * r` → `6.28318 * r`
- **حذف کد مرده:** `if (false) { ... }` → حذف کامل
- **ساده‌سازی:** `x = y + 0;` → `x = y;`

### فاز ۶: تولید کد

تولید کد ماشین باینری برای CPU خاص.

```
mov  eax, edi        ; انتقال آرگومان اول
add  eax, esi        ; جمع آرگومان دوم
ret                  ; بازگشت
```

### فاز ۷: پیوند (Linking)

ترکیب کد شما با کتابخانه‌های استاندارد (printf، sqrt، و غیره).

---

## مزایا و معایب کامپایل

| مزایا | معایب |
|-------|-------|
| سریع‌ترین سرعت اجرا | نیاز به کامپایل قبل از اجرا |
| خطاها قبل از اجرا گرفته می‌شوند | وابسته به پلتفرم |
| کد بهینه شده | زمان کامپایل ممکن است طولانی باشد |
| فایل اجرایی مستقل | چرخه ویرایش-اجرای طولانی‌تر |

---

## نکات کلیدی

۱. **کامپایل** = ترجمه یک‌باره کل کد به کد ماشین
۲. **۷ فاز** = تحلیل لغوی → نحوی → معنایی → کد میانی → بهینه‌سازی → تولید کد → پیوند
۳. **هدف:** فایل اجرایی مستقل و سریع
۴. **زبان‌های کامپایل شده:** C، C++، Rust، Go، Fortran
