# فرآیند تفسیر: اجرای خط به خط

## به زبان ساده

**چه چیزی یاد می‌گیرید:** برخی زبان‌های برنامه‌نویسی مانند پایتون و جاوااسکریپت بدون کامپایل اجرا می‌شوند. در عوض، یک **مفسر** کد شما را می‌خواند و آن را به صورت **خط به خط** اجرا می‌کند. این مقاله نحوه کار تفسیر، تفاوت آن با کامپایل، و مزایا و معایبش را توضیح می‌دهد.

**نکته برای تازه‌کاران:** تفسیر را مانند داشتن یک مترجم همزمان در نظر بگیرید. شما یک خط کد می‌نویسید، مفسر آن را می‌خواند، ترجمه می‌کند، و بلافاصله اجرا می‌کند—هیچ فایل اجرایی ایجاد نمی‌شود.

---

## تفسیر چیست؟ (تعریف ساده)

**تفسیر** فرآیند خواندن و اجرای کد منبع **در زمان اجرا** است—خط به خط، بدون ایجاد فایل اجرایی.

```
┌─────────────────────────────────────────────────────────────────────┐
│                    کامپایل در مقابل تفسیر                          │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  کامپایل (C++):                                                      │
│  ═════════════════════════════════════════════════════════==         │
│                                                                      │
│  کد منبع ──[کامپایل]──> کد ماشین ──[اجرا]──> نتیجه                  │
│     ↑         (یک‌بار)     (.exe)      (سریع)                       │
│     │                                                                │
│     └────── بعد از کامپایل، فایل اجرایی قابل اجراست ────────>        │
│                                                                      │
│  تفسیر (پایتون):                                                     │
│  ═════════════════════════════════════════════════════════==         │
│                                                                      │
│  کد منبع ──[مفسر می‌خواند]──> [ترجمه]──> [اجرا]──> نتیجه            │
│     ↑         ↓           ↓        ↓                               │
│     │      خط ۱          خط ۱      خط ۱                              │
│     │      خط ۲          خط ۲      خط ۲                              │
│     │      خط ۳          خط ۳      خط ۳                              │
│     │                                                                │
│     └────── هر بار اجرا، کد دوباره ترجمه می‌شود ──────────>          │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## چگونه تفسیر کار می‌کند

```
┌─────────────────────────────────────────────────────────────────────┐
│                    چرخه تفسیر خط به خط                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐     │
│  │   خواندن   │──> │   تجزیه   │──> │   اجرا    │──> │   ادامه   │     │
│  │   خط N    │    │   خط N    │    │   خط N    │    │   خط N+1  │     │
│  └──────────┘    └──────────┘    └──────────┘    └──────────┘     │
│       ↑                                              │              │
│       └────────────────────────────────────────────────┘              │
│                     (تکرار تا پایان کد)                               │
│                                                                      │
│  مفسر این مراحل را برای هر خط کد تکرار می‌کند!                      │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## انواع مفسرها

### ۱. مفسر خالص (Pure Interpreter)

هر خط را مستقیماً از کد منبع می‌خواند و اجرا می‌کند.

**مثال:** پایتون اولیه، شل اسکریپت‌ها

```
کد منبع ← مفسر ← اجرا
```

### ۲. مفسر بایت‌کد (Bytecode Interpreter)

ابتدا کد منبع را به یک فرمت میانی (بایت‌کد) تبدیل می‌کند، سپس آن را اجرا می‌کند.

**مثال:** پایتون مدرن، جاوا، C#

```
کد منبع ← کامپایل به بایت‌کد ← ماشین مجازی ← اجرا
```

### ۳. JIT (Just-In-Time Compiler)

بایت‌کد را در زمان اجرا به کد ماشین کامپایل می‌کند.

**مثال:** V8 (جاوااسکریپت Chrome)، PyPy (پایتون)

---

## مثال: تفسیر در پایتون

```python
# کد پایتون (source.py)
x = 5
y = 10
result = x + y
print(result)
```

**آنچه مفسر انجام می‌دهد:**

| مرحله | عملیات | توضیح |
|-------|--------|-------|
| ۱ | خواندن `x = 5` | تشخیص: انتساب عدد صحیح |
| ۲ | تجزیه `x = 5` | ایجاد دستورالعمل: ایجاد متغیر x = 5 |
| ۳ | اجرا | x = 5 در حافظه ذخیره می‌شود |
| ۴ | خواندن `y = 10` | تشخیص: انتساب عدد صحیح |
| ۵ | تجزیه `y = 10` | ایجاد دستورالعمل: ایجاد متغیر y = 10 |
| ۶ | اجرا | y = 10 در حافظه ذخیره می‌شود |
| ۷ | خواندن `result = x + y` | تشخیص: عملیات جمع |
| ۸ | تجزیه `result = x + y` | ایجاد دستورالعمل: جمع و ذخیره |
| ۹ | اجرا | x + y = 15، result = 15 |
| ۱۰ | خواندن `print(result)` | تشخیص: فراخوانی تابع |
| ۱۱ | اجرا | چاپ ۱۵ روی صفحه |

---

## مزایا و معایب تفسیر

| مزایا | معایب |
|-------|-------|
| توسعه سریع (چرخه ویرایش-اجرای سریع) | کندتر از کامپایل |
| قابل حمل (یک کد، چند پلتفرم) | نیاز به مفسر برای اجرا |
| خطایابی آسان (خطاها هنگام اجرا) | مصرف حافظه بیشتر |
| انعطاف‌پذیری بالا | کد منبع قابل مشاهده است |

---

## زبان‌های تفسیری

| زبان | نوع تفسیر | استفاده اصلی |
|------|-----------|--------------|
| **پایتون** | بایت‌کد + VM | علم داده، اتوماسیون، وب |
| **جاوااسکریپت** | JIT (V8) | توسعه وب فرانت‌اند |
| **PHP** | تفسیر | توسعه وب سمت سرور |
| **Ruby** | بایت‌کد | توسعه وب، اسکریپت‌نویسی |
| **Bash** | خالص | اسکریپت‌نویسی سیستم |
| **Perl** | خالص | پردازش متن، اسکریپت‌نویسی |

---

## تفسیر در مقابل کامپایل: مقایسه کامل

| جنبه | کامپایل (C++) | تفسیر (پایتون) |
|------|---------------|----------------|
| **سرعت توسعه** | کند (چرخه ویرایش-کامپایل-اجرای طولانی) | سریع (اجرا فوری) |
| **سرعت اجرا** | سریع | کندتر |
| **قابلیت حمل** | نیاز به کامپایل مجدد برای هر پلتفرم | یک کد در همه پلتفرم‌ها |
| **اشکال‌زدایی** | خطاها قبل از اجرا گرفته می‌شوند | خطاها در زمان اجرا |
| **توزیع** | فایل اجرایی مستقل | نیاز به کد منبع + مفسر |
| **بهینه‌سازی** | عالی (کامپایلر زمان دارد) | محدود (در زمان اجرا) |
| **انعطاف‌پذیری** | کمتر (تصمیمات در زمان کامپایل) | بیشتر (تصمیمات در زمان اجرا) |

---

## نکات کلیدی

۱. **تفسیر** = خواندن و اجرای خط به خط کد منبع در زمان اجرا
۲. **مفسر** برنامه‌ای است که کد را می‌خواند، تجزیه می‌کند، و بلافاصله اجرا می‌کند
۳. **مزایای اصلی:** توسعه سریع، قابلیت حمل، انعطاف‌پذیری
۴. **معایب اصلی:** سرعت اجرای کمتر، نیاز به مفسر
۵. **پایتون** از یک رویکرد ترکیبی استفاده می‌کند: کامپایل به بایت‌کد، سپس تفسیر توسط ماشین مجازی
