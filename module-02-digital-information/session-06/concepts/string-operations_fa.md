# عملیات رشته: کار با متن در کامپیوتر

## مقدمه: قدرت دستکاری متن

برنامه‌نویسان با متن بیشتر از هر چیز دیگری کار می‌کنند. چه در حال پردازش ورودی کاربر، پردازش فایل‌ها یا تولید خروجی باشید، **عملیات رشته** مهارت اصلی است.

یک **رشته** فقط دنباله‌ای از کاراکترهاست: `"سلام"` یا `"Hello"` یا `"12345"`.

کامپیوترها در واقع حروف ذخیره نمی‌کنند - اعداد را ذخیره می‌کنند (به یاد بیاورید کدگذاری کاراکتر!). عملیات رشته به ما اجازه می‌دهند این اعداد را به شیوه‌های معنادار دستکاری کنیم.

---

## ایجاد و نمایش رشته‌ها

### رشته‌ها در کد

**Python:**
```python
greeting = "سلام دنیا"
name = 'علی'
quote = """این یک
رشته چندخطی است"""

# f-strings (فرمت‌بندی رشته)
age = 25
message = f"علی {age} سال دارد"
# نتیجه: "علی 25 سال دارد"
```

**JavaScript:**
```javascript
let greeting = "سلام دنیا";
let name = 'علی';
let template = `علی ${age} سال دارد`;
```

**Java:**
```java
String greeting = "سلام دنیا";
String formatted = String.format("علی %d سال دارد", 25);
```

### ویژگی‌های رشته

| ویژگی | Python | JavaScript | Java | توضیحات |
|-------|--------|------------|------|---------|
| طول | `len(s)` | `s.length` | `s.length()` | شمارش کاراکترها |
| نوع | `str` | `string` | `String` | نوع داده |
| قابل تغییر؟ | نه | نه | نه | رشته‌ها تغییرناپذیر هستند |

---

## دسترسی به کاراکترها: اندیس‌گذاری

### اندیس‌گذاری مبتنی بر صفر

در بیشتر زبان‌ها، **اولین کاراکتر اندیس ۰ دارد**:

```
رشته:  P  y  t  h  o  n
اندیس: 0  1  2  3  4  5

"Python"[0] = "P"
"Python"[3] = "h"
```

### مثال‌ها

**Python:**
```python
text = "برنامه‌نویسی"

first = text[0]    # "ب"
third = text[2]    # "ن"
last = text[-1]    # "ی" (منفی = از انتها)
```

**JavaScript:**
```javascript
let text = "برنامه‌نویسی";

let first = text[0];    // "ب"
let last = text[text.length - 1];  // "ی"
```

---

## برش (Slice): دریافت زیررشته‌ها

### نحوه برش کار می‌کند

**برش** به شما زیرمجموعه‌ای از یک رشته می‌دهد:
```
سینتکس: string[start:end]
- start: اندیس شروع (شامل)
- end: اندیس پایان (غیرشامل)
```

### مثال‌های برش

**Python:**
```python
text = "برنامه‌نویسی پایتون"

# برش پایه
text[0:8]      # "برنامه‌نویسی" (اندیس‌های ۰ تا ۷)
text[9:]       # "پایتون" (از ۹ تا انتها)
text[:8]       # "برنامه‌نویسی" (از ابتدا تا ۷)

# برش با گام
text[::2]      # هر دومین کاراکتر: "برم‌ویسیایتن"
text[::-1]     # برعکس: "نوتیاپ یسیون‌امنرب"
```

**JavaScript:**
```javascript
let text = "برنامه‌نویسی پایتون";

text.slice(0, 8);   // "برنامه‌نویسی"
text.substring(9);  // "پایتون"
```

---

## عملیات اصلاح رشته

### بزرگ و کوچک کردن

**Python:**
```python
text = "Hello World"

text.upper()       # "HELLO WORLD"
text.lower()       # "hello world"
text.title()       # "Hello World" (بزرگ کردن اول هر کلمه)
text.capitalize()  # "Hello world" (فقط اولین حرف)
```

**JavaScript:**
```javascript
let text = "Hello World";

text.toUpperCase();  // "HELLO WORLD"
text.toLowerCase();  // "hello world"
```

### جستجو و جایگزینی

**Python:**
```python
text = "برنامه‌نویسی پایتون"

# پیدا کردن موقعیت
text.find("پایتون")       # ۹ (یا -۱ اگر پیدا نشد)
text.index("پایتون")      # ۹ (یا خطا اگر پیدا نشد)
text.count("ن")           # ۳ ("ن" چند بار ظاهر می‌شود)

# جستجو
"پایتون" in text        # True

# جایگزینی
text.replace("پایتون", "جاوا")  # "برنامه‌نویسی جاوا"
```

**JavaScript:**
```javascript
let text = "برنامه‌نویسی پایتون";

text.indexOf("پایتون");    // 9
text.includes("پایتون");   // true
text.replace("پایتون", "جاوا");  // "برنامه‌نویسی جاوا"
```

### حذف فضای خالی

**Python:**
```python
text = "   سلام   "

text.strip()       # "سلام" (همه فضاها)
text.lstrip()      # "سلام   " (فقط چپ)
text.rstrip()      # "   سلام" (فقط راست)
```

**JavaScript:**
```javascript
let text = "   سلام   ";

text.trim();        // "سلام"
text.trimStart();   // "سلام   "
text.trimEnd();     // "   سلام"
```

---

## تجزیه و ترکیب

### تقسیم (تجزیه)

**تقسیم** یک رشته را به قطعات کوچکتر بر اساس جداکننده تقسیم می‌کند:

**Python:**
```python
# تقسیم بر اساس فاصله
text = "پایتون جاوا سی‌شارپ"
words = text.split()        # ["پایتون", "جاوا", "سی‌شارپ"]

# تقسیم بر اساس کاراکتر خاص
csv = "علی,احمد,رضا"
names = csv.split(",")      # ["علی", "احمد", "رضا"]

# تقسیم با حد
sentence = "یک دو سه چهار"
words = sentence.split(" ", 2)  # ["یک", "دو", "سه چهار"] (فقط ۲ تقسیم)
```

**JavaScript:**
```javascript
let csv = "علی,احمد,رضا";
let names = csv.split(",");    // ["علی", "احمد", "رضا"]
```

### پیوستن (ترکیب)

**پیوستن** چندین رشته را به یک رشته ترکیب می‌کند:

**Python:**
```python
words = ["پایتون", "جاوا", "سی‌شارپ"]
sentence = " ".join(words)    # "پایتون جاوا سی‌شارپ"

csv = ",".join(words)         # "پایتون,جاوا,سی‌شارپ"
```

**JavaScript:**
```javascript
let words = ["پایتون", "جاوا", "سی‌شارپ"];
let sentence = words.join(" ");  // "پایتون جاوا سی‌شارپ"
```

---

## فرمت‌بندی رشته

### f-strings (پایتون ۳.۶+)

```python
name = "علی"
age = 25
price = 1234.56

# اساسی
f"{name} {age} سال دارد"              # "علی 25 سال دارد"

# با فرمت
f"{name:>10}"                        # "       علی" (چپ‌چین، عرض ۱۰)
f"{price:.2f}"                       # "1234.56" (۲ رقم اعشار)
f"{price:>10.2f}"                    # "   1234.56" (عرض ۱۰، ۲ رقم اعشار)
```

### روش format()

```python
"{} {} سال دارد".format(name, age)   # "علی 25 سال دارد"
"{0} {1} سال دارد".format(name, age)
"{n} {a} سال دارد".format(n=name, a=age)
```

### فرمت‌بندی درصد (قدیمی)

```python
"%s %d سال دارد" % (name, age)       # "علی 25 سال دارد"
"%.2f" % price                       # "1234.56"
```

### فرمت‌بندی JavaScript

```javascript
// Template literals (ES6)
let message = `${name} ${age} سال دارد`;

// Internationalization API
new Intl.NumberFormat('fa-IR').format(1234.56);  // "۱٬۲۳۴٫۵۶"
```

---

## عملیات پیشرفته

### بررسی محتوا

**Python:**
```python
text = "Hello123"

text.isalpha()       # False (شامل اعداد است)
text.isalnum()       # True (فقط حروف و اعداد)
text.isdigit()       # False
"123".isdigit()      # True

text.startswith("Hel")  # True
text.endswith("123")    # True
```

**JavaScript:**
```javascript
let text = "Hello123";

/^\d+$/.test(text);      // false (همه اعداد؟)
/^\w+$/.test(text);      // true (حروف/اعداد/زیرخط؟)
text.startsWith("Hel");   // true
text.endsWith("123");     // true
```

### تراز کردن و پر کردن

**Python:**
```python
text = "علی"

text.center(10)      # "    علی     " (مرکز)
text.ljust(10)       # "علی        " (چپ)
text.rjust(10)       # "        علی" (راست)

"42".zfill(5)        # "00042" (صفر پیشرو)
```

### ترجمه کاراکتر

**Python:**
```python
# جایگزینی چند کاراکتر
text = "hello world"
table = str.maketrans("aeiou", "12345")
text.translate(table)  # "h2ll4 w4rld"

# حذف کاراکترها
table = str.maketrans("", "", "aeiou")  # حذف صدادارها
text.translate(table)  # "hll wrld"
```

---

## اعتبارسنجی ورودی

### بررسی خالی بودن

**Python:**
```python
user_input = input("نام را وارد کنید: ")

if not user_input:           # اگر خالی باشد
    print("نام نمی‌تواند خالی باشد!")
    
if not user_input.strip():   # اگر فقط فاصله باشد
    print("نام معتبر نیست!")
```

**JavaScript:**
```javascript
let input = prompt("نام را وارد کنید:");

if (!input || !input.trim()) {
    alert("نام معتبر نیست!");
}
```

### اعتبارسنجی فرمت

**اعتبارسنجی ایمیل (ساده):**
```python
import re

def is_valid_email(email):
    pattern = r'^[\w\.-]+@[\w\.-]+\.\w+$'
    return re.match(pattern, email) is not None

# آزمایش
is_valid_email("test@example.com")    # True
is_valid_email("invalid-email")       # False
```

**اعتبارسنجی تلفن:**
```python
def is_valid_phone(phone):
    # فقط اعداد، حداقل ۱۰ رقم
    digits = ''.join(filter(str.isdigit, phone))
    return len(digits) >= 10
```

---

## عبارات منظم (Regex)

### مقدمه کوتاه

**عبارات منظم** الگوهای جستجوی قدرتمند برای متن هستند.

| الگو | معنی | مثال |
|------|------|------|
| `.` | هر کاراکتر | `h.t` → "hat", "hot", "hit" |
| `*` | ۰ یا بیشتر | `ab*` → "a", "ab", "abb" |
| `+` | ۱ یا بیشتر | `ab+` → "ab", "abb" |
| `?` | ۰ یا ۱ | `ab?` → "a", "ab" |
| `\d` | هر رقم | `\d{3}` → ۳ رقم |
| `\w` | هر کلمه‌ای | `\w+` → کلمه |
| `^` | شروع رشته | `^Hello` |
| `$` | پایان رشته | `world$` |

### مثال‌های Regex در پایتون

```python
import re

text = "آدرس من test@example.com است"

# جستجو
match = re.search(r'\w+@\w+\.\w+', text)
if match:
    print(match.group())  # "test@example.com"

# یافتن همه
emails = re.findall(r'\w+@\w+\.\w+', text)

# جایگزینی
clean = re.sub(r'\d{3}-\d{4}', '****-****', "0912-3456")  # "****-****"

# تقسیم
words = re.split(r'\s+', "چند    فاصله\tو\nخط")  # ["چند", "فاصله", "و", "خط"]
```

---

## نرمال‌سازی رشته

### چرا نرمال‌سازی؟

همان متن می‌تواند با نقاط کد یونیکد متفاوت نمایش داده شود!

**مثال مشکل:**
```
"é" می‌تواند ذخیره شود به صورت:
- U+00E9 (یک کاراکتر: "é")
- U+0065 U+0301 (دو کاراکتر: "e" + "´" ترکیب‌شونده)
```

**هر دو یکسان به نظر می‌رسند الی در کامپیوتر متفاوت هستند!**

### نرمال‌سازی در پایتون

```python
import unicodedata

# فرم‌های نرمال‌سازی
text = "café"

# NFC: ترکیب حروف ترکیب‌شونده
nfc = unicodedata.normalize('NFC', text)

# NFD: تفکیک حروف ترکیب‌شونده
nfd = unicodedata.normalize('NFD', text)

# مقایسه
if nfc == nfd:  # ممکن است False باشد!
    print("یکسان")
```

### مرتب‌سازی فارسی/عربی

```python
# مرتب‌سازی با توجه به قوانین زبان
texts = ["باب", "آب", "پدر"]
sorted(texts)  # ["آب", "باب", "پدر"] (الفبایی)
```

---

## عملکرد و کارایی

### رشته‌ها تغییرناپذیر هستند

**به یاد داشته باشید**: رشته‌ها تغییرناپذیرند - هر "تغییر" یک رشته جدید می‌سازد:

```python
# اشتباه (کارایی پایین)
result = ""
for i in range(1000):
    result += str(i)  # ۱۰۰۰ رشته جدید!

# درست (کارایی بالا)
parts = []
for i in range(1000):
    parts.append(str(i))
result = "".join(parts)  # فقط ۱ رشته جدید

# یا از StringIO (پایتون)
from io import StringIO
buffer = StringIO()
for i in range(1000):
    buffer.write(str(i))
result = buffer.getvalue()
```

### مقایسه رشته

**پایتون:**
```python
# مقایسه برابری
if name == "علی":
    print("سلام علی!")

# مقایسه بدون به بزرگی/کوچکی
if name.lower() == "علی":
    print("سلام علی!")

# مقایسه با contains
if "test" in email:
    print("این یک ایمیل تست است")
```

---

## تمرین‌های عملی

### تمرین ۱: دستکاری پایه

```python
text = "  برنامه‌نویسی پایتون  "

# این را انجام دهید:
# ۱. فاصله‌ها را حذف کنید
# ۲. به حروف کوچک تبدیل کنید (اگر انگلیسی باشد)
# ۳. "پایتون" را با "جاوا" جایگزین کنید
# ۴. کلمه اول را استخراج کنید
```

### تمرین ۲: اعتبارسنجی

یک تابع بنویسید که:
- بررسی کند آیا رمز عبور حداقل ۸ کاراکتر دارد
- حداقل یک حرف بزرگ، یک حرف کوچک، و یک عدد دارد
- نتیجه True/False برگرداند

### تمرین ۳: تجزیه

```python
data = "علی,۲۵,تهران|احمد,۳۰,اصفهان|رضا,۳۵,مشهد"

# این را به لیستی از دیکشنری‌ها تبدیل کنید:
# [{"name": "علی", "age": 25, "city": "تهران"}, ...]
```

### تمرین ۴: فرمت‌بندی

```python
# این داده‌ها را در قالب خوبی نمایش دهید:
products = [
    ("لپ‌تاپ", 15000000),
    ("موس", 250000),
    ("کیبورد", 800000)
]

# خروجی:
# لپ‌تاپ        ۱۵,۰۰۰,۰۰۰ ریال
# موس             ۲۵۰,۰۰۰ ریال
# کیبورد          ۸۰۰,۰۰۰ ریال
```

---

## نکات کلیدی

۱. **رشته‌ها دنباله‌ای از کاراکترها هستند** که به عنوان اعداد ذخیره می‌شوند
۲. **اندیس‌گذاری مبتنی بر صفر**: اولین کاراکتر اندیس ۰ دارد
۳. **رشته‌ها تغییرناپذیرند**: هر تغییر یک رشته جدید می‌سازد
۴. **برش راهی قدرتمند** برای دریافت زیررشته‌ها است
۵. **فرمت‌بندی** خروجی خواندنی می‌سازد
۶. **Regex** برای الگوهای جستجوی پیچیده است
۷. **به کارایی فکر کنید** وقتی با رشته‌های بزرگ کار می‌کنید

## به یاد داشته باشید

| عملیات | پایتون | JavaScript | توضیحات |
|--------|--------|------------|---------|
| طول | `len(s)` | `s.length` | شمارش کاراکترها |
| اندیس‌گذاری | `s[0]` | `s[0]` | دسترسی به کاراکتر |
| برش | `s[0:5]` | `s.slice(0,5)` | زیررشته |
| جستجو | `s.find(x)` | `s.indexOf(x)` | موقعیت کاراکتر |
| جایگزینی | `s.replace(a,b)` | `s.replace(a,b)` | تغییر متن |
| تقسیم | `s.split(d)` | `s.split(d)` | جدا کردن |
| پیوستن | `d.join(l)` | `l.join(d)` | ترکیب |

---

## گام‌های بعدی

- تمرین با کتابخانه‌های پردازش متن (NLTK، spaCy)
- یادگیری عبارات منظم پیشرفته
- بررسی پردازش متن چندزبانه
- بررسی تفاوت بین رشته‌ها و بایت‌ها
